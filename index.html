<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SuperShop - –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –ú–∞–≥–∞–∑–∏–Ω</title>
    <style>
        /* ===== –û–°–ù–û–í–ù–´–ï –°–¢–ò–õ–ò ===== */
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --success: #27ae60;
            --danger: #e74c3c;
            --warning: #f39c12;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --gray: #95a5a6;
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
            --radius: 8px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }

        /* ===== –®–ê–ü–ö–ê ===== */
        header {
            background: white;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
        }

        .logo-icon {
            color: var(--secondary);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .balance {
            background: var(--primary);
            color: white;
            padding: 8px 16px;
            border-radius: var(--radius);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* ===== –ö–ù–û–ü–ö–ò ===== */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .btn-primary {
            background: var(--secondary);
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--danger);
            color: white;
        }

        .btn-secondary:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--secondary);
            color: var(--secondary);
        }

        .btn-outline:hover {
            background: var(--secondary);
            color: white;
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 13px;
        }

        /* ===== –ö–û–ù–¢–ï–ô–ù–ï–† ===== */
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        /* ===== –ö–ê–†–¢–û–ß–ö–ò ===== */
        .card {
            background: white;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        /* ===== –§–û–†–ú–´ ===== */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: var(--radius);
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--secondary);
        }

        /* ===== –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê ===== */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1001;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: var(--radius);
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlide 0.3s ease;
        }

        @keyframes modalSlide {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .modal-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--gray);
        }

        /* ===== –¢–ê–ë–´ ===== */
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 2rem;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }

        .tab {
            padding: 10px 20px;
            background: none;
            border: none;
            border-radius: var(--radius) var(--radius) 0 0;
            cursor: pointer;
            font-weight: 600;
            color: var(--gray);
        }

        .tab.active {
            background: var(--secondary);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* ===== –¢–û–í–ê–†–´ ===== */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 2rem;
        }

        .product-card {
            background: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
        }

        .product-image {
            height: 200px;
            background: linear-gradient(45deg, var(--light), var(--gray));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
        }

        .product-info {
            padding: 1.5rem;
        }

        .product-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--dark);
        }

        .product-description {
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 1rem;
            line-height: 1.4;
        }

        .product-price {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--success);
            margin-bottom: 1rem;
        }

        .product-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #eee;
        }

        .product-stock {
            color: var(--success);
            font-weight: 600;
        }

        .product-stock.out {
            color: var(--danger);
        }

        /* ===== –ó–ê–ö–ê–ó–´ ===== */
        .order-card {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: var(--radius);
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .order-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-completed {
            background: #d4edda;
            color: #155724;
        }

        .status-cancelled {
            background: #f8d7da;
            color: #721c24;
        }

        /* ===== –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ ===== */
        .admin-panel {
            background: white;
            border-radius: var(--radius);
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: var(--shadow);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--light);
            padding: 1.5rem;
            border-radius: var(--radius);
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            margin: 10px 0;
        }

        .stat-label {
            color: var(--gray);
            font-size: 0.9rem;
        }

        /* ===== –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø ===== */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 1rem 1.5rem;
            border-radius: var(--radius);
            color: white;
            font-weight: 600;
            z-index: 1002;
            animation: slideIn 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: var(--shadow);
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .notification.success {
            background: var(--success);
        }

        .notification.error {
            background: var(--danger);
        }

        .notification.warning {
            background: var(--warning);
        }

        /* ===== –£–¢–ò–õ–ò–¢–´ ===== */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .mt-20 {
            margin-top: 20px;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        .loading {
            text-align: center;
            padding: 3rem;
            color: var(--gray);
        }

        .loading-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* ===== –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ ===== */
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                gap: 15px;
            }
            
            .user-info {
                width: 100%;
                justify-content: space-between;
            }
            
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
                gap: 15px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 0 10px;
            }
            
            .products-grid {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-wrap: wrap;
            }
            
            .btn {
                padding: 8px 15px;
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <!-- –®–ê–ü–ö–ê -->
    <header>
        <div class="header-container">
            <div class="logo">
                <span class="logo-icon">üõí</span>
                <span>SuperShop</span>
            </div>
            <div class="user-info">
                <div class="balance">
                    <span>üí∞</span>
                    <span id="balanceAmount">0 ‚Ç¥</span>
                </div>
                <button class="btn btn-outline btn-sm" onclick="showAuthModal()" id="authBtn">
                    <span>üë§</span>
                    <span id="authBtnText">–í–æ–π—Ç–∏</span>
                </button>
                <button class="btn btn-secondary btn-sm hidden" onclick="logout()" id="logoutBtn">
                    <span>üö™</span>
                    <span>–í—ã–π—Ç–∏</span>
                </button>
                <button class="btn btn-primary btn-sm" onclick="toggleAdminPanel()" id="adminBtn">
                    <span>‚öôÔ∏è</span>
                    <span>–ê–¥–º–∏–Ω–∫–∞</span>
                </button>
            </div>
        </div>
    </header>

    <!-- –û–°–ù–û–í–ù–û–ô –ö–û–ù–¢–ï–ù–¢ -->
    <div class="container">
        <!-- –¢–ê–ë–´ -->
        <div class="tabs">
            <button class="tab active" onclick="showTab('products')">üõçÔ∏è –¢–æ–≤–∞—Ä—ã</button>
            <button class="tab" onclick="showTab('orders')">üì¶ –ú–æ–∏ –∑–∞–∫–∞–∑—ã</button>
            <button class="tab" onclick="showTab('profile')">üë§ –ü—Ä–æ—Ñ–∏–ª—å</button>
        </div>

        <!-- –¢–ê–ë –¢–û–í–ê–†–û–í -->
        <div id="productsTab" class="tab-content active">
            <div id="productsContainer">
                <!-- –¢–æ–≤–∞—Ä—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∑–¥–µ—Å—å -->
                <div class="loading">
                    <div class="loading-icon">üîÑ</div>
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...</p>
                </div>
            </div>
        </div>

        <!-- –¢–ê–ë –ó–ê–ö–ê–ó–û–í -->
        <div id="ordersTab" class="tab-content">
            <h2 class="mb-20">üì¶ –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</h2>
            <div id="ordersContainer">
                <div class="loading">
                    <div class="loading-icon">üîÑ</div>
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤...</p>
                </div>
            </div>
        </div>

        <!-- –¢–ê–ë –ü–†–û–§–ò–õ–Ø -->
        <div id="profileTab" class="tab-content">
            <h2 class="mb-20">üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h2>
            <div class="card">
                <div class="modal-body">
                    <div class="form-group">
                        <label class="form-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                        <input type="text" class="form-control" id="profileUsername" disabled>
                    </div>
                    <div class="form-group">
                        <label class="form-label">–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:</label>
                        <input type="text" class="form-control" id="profileCreatedAt" disabled>
                    </div>
                    <div class="form-group">
                        <label class="form-label">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏:</label>
                        <textarea class="form-control" id="profileAddress" rows="3" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∞–¥—Ä–µ—Å"></textarea>
                    </div>
                    <button class="btn btn-primary" onclick="saveProfile()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                </div>
            </div>
        </div>

        <!-- –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ -->
        <div id="adminPanel" class="admin-panel hidden">
            <div class="tabs">
                <button class="tab active" onclick="showAdminTab('adminStats')">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                <button class="tab" onclick="showAdminTab('adminOrders')">üì¶ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏</button>
                <button class="tab" onclick="showAdminTab('adminProducts')">üõçÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</button>
                <button class="tab" onclick="showAdminTab('adminUsers')">üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</button>
                <button class="tab" onclick="showAdminTab('adminSettings')">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            </div>

            <!-- –°–¢–ê–¢–ò–°–¢–ò–ö–ê -->
            <div id="adminStats" class="tab-content active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div>üë•</div>
                        <div class="stat-value" id="totalUsers">0</div>
                        <div class="stat-label">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                    </div>
                    <div class="stat-card">
                        <div>üõçÔ∏è</div>
                        <div class="stat-value" id="totalProducts">0</div>
                        <div class="stat-label">–¢–æ–≤–∞—Ä–æ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div>üí∞</div>
                        <div class="stat-value" id="totalRevenue">0 ‚Ç¥</div>
                        <div class="stat-label">–í—ã—Ä—É—á–∫–∞</div>
                    </div>
                    <div class="stat-card">
                        <div>üì¶</div>
                        <div class="stat-value" id="totalOrders">0</div>
                        <div class="stat-label">–ó–∞–∫–∞–∑–æ–≤</div>
                    </div>
                </div>
            </div>

            <!-- –£–ü–†–ê–í–õ–ï–ù–ò–ï –ó–ê–ö–ê–ó–ê–ú–ò -->
            <div id="adminOrders" class="tab-content">
                <h3 class="mb-20">üì¶ –í—Å–µ –∑–∞–∫–∞–∑—ã</h3>
                <div id="allOrdersContainer">
                    <p class="text-center">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤...</p>
                </div>
            </div>

            <!-- –£–ü–†–ê–í–õ–ï–ù–ò–ï –¢–û–í–ê–†–ê–ú–ò -->
            <div id="adminProducts" class="tab-content">
                <h3 class="mb-20">üõçÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h3>
                <div class="card">
                    <div class="modal-body">
                        <div class="form-group">
                            <label class="form-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
                            <select class="form-control" id="productCategorySelect">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞:</label>
                            <input type="text" class="form-control" id="productName" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ">
                        </div>
                        <div class="form-group">
                            <label class="form-label">–¶–µ–Ω–∞ (‚Ç¥):</label>
                            <input type="number" class="form-control" id="productPrice" placeholder="0.00" step="0.01">
                        </div>
                        <div class="form-group">
                            <label class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</label>
                            <input type="number" class="form-control" id="productStock" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                            <textarea class="form-control" id="productDescription" rows="3" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞"></textarea>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-primary" onclick="saveProduct()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
                            <button class="btn btn-secondary" onclick="deleteProduct()">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –£–ü–†–ê–í–õ–ï–ù–ò–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø–ú–ò -->
            <div id="adminUsers" class="tab-content">
                <h3 class="mb-20">üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h3>
                <div class="form-group">
                    <input type="text" class="form-control" id="userSearch" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è..." oninput="searchUsers()">
                </div>
                <div id="usersList" class="mt-20">
                    <!-- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
                </div>
            </div>

            <!-- –ù–ê–°–¢–†–û–ô–ö–ò -->
            <div id="adminSettings" class="tab-content">
                <h3 class="mb-20">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã</h3>
                <div class="card">
                    <div class="modal-body">
                        <div class="form-group">
                            <label class="form-label">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:</label>
                            <input type="password" class="form-control" id="newAdminPassword" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å">
                        </div>
                        <div class="form-group">
                            <label class="form-label">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å:</label>
                            <input type="password" class="form-control" id="confirmAdminPassword" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                        </div>
                        <button class="btn btn-primary" onclick="changeAdminPassword()">üîê –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò -->
    <div id="authModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üîê –í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h3>
                <button class="close-btn" onclick="closeAuthModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</label>
                    <input type="text" class="form-control" id="authUsername" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                </div>
                <div class="form-group">
                    <label class="form-label">–ü–∞—Ä–æ–ª—å:</label>
                    <input type="password" class="form-control" id="authPassword" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" onclick="login()">üëâ –í–æ–π—Ç–∏</button>
                    <button class="btn btn-success" onclick="register()">‚ú® –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ê–î–ú–ò–ù –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò -->
    <div id="adminAuthModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üîê –í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</h3>
                <button class="close-btn" onclick="closeAdminAuthModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">–ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:</label>
                    <input type="password" class="form-control" id="adminAuthPassword" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" onclick="loginAdmin()">‚úÖ –í–æ–π—Ç–∏ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û –ü–†–û–°–ú–û–¢–†–ê –¢–û–í–ê–†–ê -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="productModalTitle">–¢–æ–≤–∞—Ä</h3>
                <button class="close-btn" onclick="closeProductModal()">√ó</button>
            </div>
            <div class="modal-body">
                <div class="product-price" id="productModalPrice"></div>
                <p id="productModalDescription"></p>
                <div class="product-meta">
                    <div id="productModalStock"></div>
                    <button class="btn btn-primary" onclick="buyCurrentProduct()">üõí –ö—É–ø–∏—Ç—å —Å–µ–π—á–∞—Å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ö–û–ù–¢–ï–ô–ù–ï–† –î–õ–Ø –£–í–ï–î–û–ú–õ–ï–ù–ò–ô -->
    <div id="notificationContainer"></div>

    <script>
        // ===================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï =====================
        let storeData = {
            users: {},
            categories: {},
            orders: [],
            adminPassword: "log21"
        };
        
        let currentUser = null;
        let currentProduct = null;
        let isAdmin = false;

        // ===================== –°–ò–°–¢–ï–ú–ù–´–ï –§–£–ù–ö–¶–ò–ò =====================
        async function get_data() {
            try {
                const response = await fetch('/get_data');
                if (!response.ok) throw new Error(`HTTP –æ—à–∏–±–∫–∞: ${response.status}`);
                const data = await response.json();
                console.log('üì• –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —Å —Å–µ—Ä–≤–µ—Ä–∞');
                return data;
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö', 'error');
                return { users: {}, categories: {}, orders: [], adminPassword: "log21" };
            }
        }

        async function save_data(data_to_save) {
            try {
                const response = await fetch('/save_data', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data_to_save)
                });
                
                if (!response.ok) throw new Error(`HTTP –æ—à–∏–±–∫–∞: ${response.status}`);
                const result = await response.json();
                console.log('üíæ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä');
                return result;
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:', error);
                showNotification('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö', 'error');
                return { success: false, error: error.message };
            }
        }

        // ===================== –§–£–ù–ö–¶–ò–ò –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò =====================
        function showAuthModal() {
            document.getElementById('authModal').classList.add('active');
        }

        function closeAuthModal() {
            document.getElementById('authModal').classList.remove('active');
        }

        async function login() {
            const username = document.getElementById('authUsername').value.trim();
            const password = document.getElementById('authPassword').value.trim();
            
            if (!username || !password) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'warning');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
            if (username === 'admin' && password === storeData.adminPassword) {
                currentUser = 'admin';
                isAdmin = true;
                localStorage.setItem('currentUser', JSON.stringify({ username: 'admin', isAdmin: true }));
                closeAuthModal();
                updateUI();
                showNotification('–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä', 'success');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±—ã—á–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            if (storeData.users[username] && storeData.users[username].password === password) {
                currentUser = username;
                isAdmin = false;
                localStorage.setItem('currentUser', JSON.stringify({ 
                    username: username, 
                    isAdmin: false,
                    address: storeData.users[username].address || ''
                }));
                closeAuthModal();
                updateUI();
                showNotification('–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
            } else {
                showNotification('–ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞', 'error');
            }
        }

        async function register() {
            const username = document.getElementById('authUsername').value.trim();
            const password = document.getElementById('authPassword').value.trim();
            
            if (!username || !password) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'warning');
                return;
            }
            
            if (username === 'admin') {
                showNotification('–ò–º—è "admin" –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ', 'error');
                return;
            }
            
            if (storeData.users[username]) {
                showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç', 'error');
                return;
            }
            
            // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            storeData.users[username] = {
                password: password,
                balance: 1000,
                address: '',
                createdAt: new Date().toISOString()
            };
            
            await save_data(storeData);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—Ö–æ–¥–∏–º
            currentUser = username;
            isAdmin = false;
            localStorage.setItem('currentUser', JSON.stringify({ 
                username: username, 
                isAdmin: false,
                address: ''
            }));
            
            closeAuthModal();
            updateUI();
            showNotification('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –í–∞–º –Ω–∞—á–∏—Å–ª–µ–Ω–æ 1000‚Ç¥', 'success');
        }

        function logout() {
            currentUser = null;
            isAdmin = false;
            localStorage.removeItem('currentUser');
            updateUI();
            showNotification('–í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã', 'warning');
        }

        // ===================== –§–£–ù–ö–¶–ò–ò –ò–ù–¢–ï–†–§–ï–ô–°–ê =====================
        function showTab(tabName) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ç–∞–±—ã
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∞–±
            document.getElementById(tabName + 'Tab').classList.add('active');
            event.target.classList.add('active');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç —Ç–∞–±–∞
            if (tabName === 'products') {
                loadProducts();
            } else if (tabName === 'orders') {
                loadUserOrders();
            } else if (tabName === 'profile') {
                loadProfile();
            }
        }

        function loadProducts() {
            const container = document.getElementById('productsContainer');
            
            if (!storeData.categories || Object.keys(storeData.categories).length === 0) {
                container.innerHTML = `
                    <div class="text-center">
                        <div style="font-size: 4rem; color: #ddd;">üõçÔ∏è</div>
                        <p style="margin-top: 20px; font-size: 1.2rem;">–¢–æ–≤–∞—Ä–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>
                        ${isAdmin ? '<p style="color: var(--gray);">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤</p>' : ''}
                    </div>
                `;
                return;
            }
            
            let html = '<div class="products-grid">';
            
            for (const [categoryName, category] of Object.entries(storeData.categories)) {
                for (const [productName, product] of Object.entries(category)) {
                    html += `
                        <div class="product-card">
                            <div class="product-image">
                                <div>üì¶</div>
                            </div>
                            <div class="product-info">
                                <h3 class="product-title">${productName}</h3>
                                <p class="product-description">${product.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç'}</p>
                                <div class="product-price">${product.price} ‚Ç¥</div>
                                <div class="product-meta">
                                    <div class="product-stock ${product.stock === 0 ? 'out' : ''}">
                                        ${product.stock === 0 ? '‚ùå –ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏' : `‚úÖ –í –Ω–∞–ª–∏—á–∏–∏: ${product.stock}`}
                                    </div>
                                    <button class="btn btn-primary btn-sm" onclick="showProduct('${categoryName}', '${productName}')">
                                        üëÅÔ∏è –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                }
            }
            
            html += '</div>';
            container.innerHTML = html;
        }

        function showProduct(category, name) {
            currentProduct = { category, name };
            const product = storeData.categories[category][name];
            
            document.getElementById('productModalTitle').textContent = name;
            document.getElementById('productModalPrice').textContent = `${product.price} ‚Ç¥`;
            document.getElementById('productModalDescription').textContent = product.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç';
            document.getElementById('productModalStock').innerHTML = `
                <div class="product-stock ${product.stock === 0 ? 'out' : ''}">
                    ${product.stock === 0 ? '‚ùå –ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏' : `‚úÖ –í –Ω–∞–ª–∏—á–∏–∏: ${product.stock} —à—Ç.`}
                </div>
            `;
            
            document.getElementById('productModal').classList.add('active');
        }

        function closeProductModal() {
            document.getElementById('productModal').classList.remove('active');
            currentProduct = null;
        }

        async function buyCurrentProduct() {
            if (!currentUser) {
                showNotification('–°–Ω–∞—á–∞–ª–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É', 'warning');
                closeProductModal();
                showAuthModal();
                return;
            }
            
            if (!currentProduct) return;
            
            const { category, name } = currentProduct;
            const product = storeData.categories[category][name];
            const user = storeData.users[currentUser];
            
            if (!product || product.stock === 0) {
                showNotification('–¢–æ–≤–∞—Ä –∑–∞–∫–æ–Ω—á–∏–ª—Å—è', 'error');
                return;
            }
            
            if (user.balance < product.price) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤', 'error');
                return;
            }
            
            // –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ–∫—É–ø–∫—É
            user.balance -= product.price;
            product.stock -= 1;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–∫–∞–∑
            const order = {
                id: Date.now().toString(),
                user: currentUser,
                product: name,
                category: category,
                price: product.price,
                status: 'pending',
                createdAt: new Date().toISOString()
            };
            
            if (!storeData.orders) storeData.orders = [];
            storeData.orders.push(order);
            
            await save_data(storeData);
            updateUI();
            closeProductModal();
            showNotification(`‚úÖ –ü–æ–∫—É–ø–∫–∞ —É—Å–ø–µ—à–Ω–∞! –ö—É–ø–ª–µ–Ω —Ç–æ–≤–∞—Ä "${name}"`, 'success');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–∫–ª–∞–¥–∫—É –∑–∞–∫–∞–∑–æ–≤
            showTab('orders');
        }

        // ===================== –§–£–ù–ö–¶–ò–ò –ó–ê–ö–ê–ó–û–í =====================
        function loadUserOrders() {
            const container = document.getElementById('ordersContainer');
            
            if (!currentUser) {
                container.innerHTML = '<p class="text-center">–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Å–≤–æ–∏ –∑–∞–∫–∞–∑—ã</p>';
                return;
            }
            
            const userOrders = (storeData.orders || []).filter(order => order.user === currentUser);
            
            if (userOrders.length === 0) {
                container.innerHTML = `
                    <div class="text-center">
                        <div style="font-size: 4rem; color: #ddd;">üì¶</div>
                        <p style="margin-top: 20px;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤</p>
                        <button class="btn btn-primary mt-20" onclick="showTab('products')">
                            üõçÔ∏è –ü–µ—Ä–µ–π—Ç–∏ –∫ —Ç–æ–≤–∞—Ä–∞–º
                        </button>
                    </div>
                `;
                return;
            }
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–Ω–∞—á–∞–ª–∞)
            userOrders.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
            
            let html = '';
            userOrders.forEach(order => {
                let statusClass = 'status-pending';
                let statusText = '‚è≥ –û–∂–∏–¥–∞–µ—Ç';
                
                if (order.status === 'completed') {
                    statusClass = 'status-completed';
                    statusText = '‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω';
                } else if (order.status === 'cancelled') {
                    statusClass = 'status-cancelled';
                    statusText = '‚ùå –û—Ç–º–µ–Ω–µ–Ω';
                }
                
                html += `
                    <div class="order-card">
                        <div class="order-header">
                            <div>
                                <h4>${order.product}</h4>
                                <small>${new Date(order.createdAt).toLocaleDateString()} ${new Date(order.createdAt).toLocaleTimeString()}</small>
                            </div>
                            <span class="order-status ${statusClass}">${statusText}</span>
                        </div>
                        <p>–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${order.category}</p>
                        <p>–¶–µ–Ω–∞: ${order.price} ‚Ç¥</p>
                        <div class="mt-20">
                            ${order.status === 'pending' ? `
                                <button class="btn btn-secondary btn-sm" onclick="cancelOrder('${order.id}')">
                                    ‚ùå –û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑
                                </button>
                            ` : ''}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        async function cancelOrder(orderId) {
            const order = storeData.orders.find(o => o.id === orderId);
            
            if (!order || order.user !== currentUser || order.status !== 'pending') {
                showNotification('–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑', 'error');
                return;
            }
            
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑?')) return;
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –¥–µ–Ω—å–≥–∏
            const user = storeData.users[currentUser];
            if (user) {
                user.balance += order.price;
            }
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–≤–∞—Ä –Ω–∞ —Å–∫–ª–∞–¥
            if (storeData.categories[order.category] && storeData.categories[order.category][order.product]) {
                storeData.categories[order.category][order.product].stock += 1;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞
            order.status = 'cancelled';
            
            await save_data(storeData);
            updateUI();
            loadUserOrders();
            showNotification('–ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω–µ–Ω', 'success');
        }

        // ===================== –§–£–ù–ö–¶–ò–ò –ü–†–û–§–ò–õ–Ø =====================
        function loadProfile() {
            if (!currentUser) {
                document.getElementById('profileTab').innerHTML = '<p class="text-center">–í–æ–π–¥–∏—Ç–µ, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –ø—Ä–æ—Ñ–∏–ª—å</p>';
                return;
            }
            
            const user = storeData.users[currentUser];
            document.getElementById('profileUsername').value = currentUser;
            document.getElementById('profileCreatedAt').value = new Date(user.createdAt).toLocaleDateString();
            document.getElementById('profileAddress').value = user.address || '';
        }

        async function saveProfile() {
            if (!currentUser) return;
            
            const address = document.getElementById('profileAddress').value.trim();
            storeData.users[currentUser].address = address;
            
            await save_data(storeData);
            showNotification('–ü—Ä–æ—Ñ–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω', 'success');
        }

        // ===================== –ê–î–ú–ò–ù –§–£–ù–ö–¶–ò–ò =====================
        function toggleAdminPanel() {
            if (!isAdmin) {
                document.getElementById('adminAuthModal').classList.add('active');
            } else {
                document.getElementById('adminPanel').classList.toggle('hidden');
                if (!document.getElementById('adminPanel').classList.contains('hidden')) {
                    loadAdminStats();
                    loadAllOrders();
                    loadAdminCategories();
                }
            }
        }

        function closeAdminAuthModal() {
            document.getElementById('adminAuthModal').classList.remove('active');
        }

        function loginAdmin() {
            const password = document.getElementById('adminAuthPassword').value;
            
            if (password === storeData.adminPassword) {
                currentUser = 'admin';
                isAdmin = true;
                localStorage.setItem('currentUser', JSON.stringify({ username: 'admin', isAdmin: true }));
                closeAdminAuthModal();
                document.getElementById('adminPanel').classList.remove('hidden');
                updateUI();
                loadAdminStats();
                loadAllOrders();
                loadAdminCategories();
                showNotification('–í—Ö–æ–¥ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –≤—ã–ø–æ–ª–Ω–µ–Ω', 'success');
            } else {
                showNotification('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞', 'error');
            }
        }

        function showAdminTab(tabName) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –∞–¥–º–∏–Ω —Ç–∞–±—ã
            document.querySelectorAll('#adminPanel .tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('#adminPanel .tab').forEach(tab => tab.classList.remove('active'));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∞–±
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–∞–±–∞
            if (tabName === 'adminStats') {
                loadAdminStats();
            } else if (tabName === 'adminOrders') {
                loadAllOrders();
            } else if (tabName === 'adminProducts') {
                loadAdminCategories();
            } else if (tabName === 'adminUsers') {
                loadUsersList();
            }
        }

        function loadAdminStats() {
            const totalUsers = Object.keys(storeData.users).length;
            let totalProducts = 0;
            let totalRevenue = 0;
            
            // –°—á–∏—Ç–∞–µ–º —Ç–æ–≤–∞—Ä—ã –∏ –≤—ã—Ä—É—á–∫—É
            for (const category of Object.values(storeData.categories)) {
                totalProducts += Object.keys(category).length;
                for (const product of Object.values(category)) {
                    totalRevenue += product.price * (product.sold || 0);
                }
            }
            
            document.getElementById('totalUsers').textContent = totalUsers;
            document.getElementById('totalProducts').textContent = totalProducts;
            document.getElementById('totalRevenue').textContent = totalRevenue + ' ‚Ç¥';
            document.getElementById('totalOrders').textContent = (storeData.orders || []).length;
        }

        function loadAllOrders() {
            const container = document.getElementById('allOrdersContainer');
            
            if (!storeData.orders || storeData.orders.length === 0) {
                container.innerHTML = '<p class="text-center">–ó–∞–∫–∞–∑–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</p>';
                return;
            }
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–Ω–∞—á–∞–ª–∞)
            const sortedOrders = [...storeData.orders].sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
            
            let html = '';
            sortedOrders.forEach(order => {
                let statusClass = 'status-pending';
                let statusText = '‚è≥ –û–∂–∏–¥–∞–µ—Ç';
                
                if (order.status === 'completed') {
                    statusClass = 'status-completed';
                    statusText = '‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω';
                } else if (order.status === 'cancelled') {
                    statusClass = 'status-cancelled';
                    statusText = '‚ùå –û—Ç–º–µ–Ω–µ–Ω';
                }
                
                html += `
                    <div class="order-card">
                        <div class="order-header">
                            <div>
                                <h4>${order.product}</h4>
                                <small>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${order.user}</small><br>
                                <small>${new Date(order.createdAt).toLocaleDateString()}</small>
                            </div>
                            <span class="order-status ${statusClass}">${statusText}</span>
                        </div>
                        <p>–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${order.category}</p>
                        <p>–¶–µ–Ω–∞: ${order.price} ‚Ç¥</p>
                        <div class="mt-20">
                            ${order.status === 'pending' ? `
                                <button class="btn btn-success btn-sm" onclick="adminUpdateOrder('${order.id}', 'completed')">
                                    ‚úÖ –û—Ç–º–µ—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º
                                </button>
                                <button class="btn btn-secondary btn-sm" onclick="adminUpdateOrder('${order.id}', 'cancelled')">
                                    ‚ùå –û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑
                                </button>
                            ` : ''}
                            ${order.status === 'completed' ? `
                                <button class="btn btn-sm" onclick="adminUpdateOrder('${order.id}', 'pending')">
                                    ‚Ü© –í–µ—Ä–Ω—É—Ç—å –≤ –æ–∂–∏–¥–∞–Ω–∏–µ
                                </button>
                            ` : ''}
                            ${order.status === 'cancelled' ? `
                                <button class="btn btn-sm" onclick="adminUpdateOrder('${order.id}', 'pending')">
                                    ‚Ü© –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–∫–∞–∑
                                </button>
                            ` : ''}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        async function adminUpdateOrder(orderId, newStatus) {
            const order = storeData.orders.find(o => o.id === orderId);
            if (!order) return;
            
            const oldStatus = order.status || 'pending';
            order.status = newStatus;
            
            // –õ–æ–≥–∏–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞/—Å–ø–∏—Å–∞–Ω–∏—è —Å—Ä–µ–¥—Å—Ç–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞
            if (oldStatus === 'pending' && newStatus === 'cancelled') {
                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –¥–µ–Ω—å–≥–∏
                const user = storeData.users[order.user];
                if (user) user.balance += order.price;
                
                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–æ–≤–∞—Ä
                if (storeData.categories[order.category] && storeData.categories[order.category][order.product]) {
                    storeData.categories[order.category][order.product].stock += 1;
                }
            } else if (oldStatus === 'cancelled' && newStatus === 'pending') {
                // –°–Ω–æ–≤–∞ —Å–ø–∏—Å—ã–≤–∞–µ–º –¥–µ–Ω—å–≥–∏
                const user = storeData.users[order.user];
                if (user && user.balance >= order.price) {
                    user.balance -= order.price;
                    
                    // –°–Ω–æ–≤–∞ —É–±–∏—Ä–∞–µ–º —Ç–æ–≤–∞—Ä
                    if (storeData.categories[order.category] && storeData.categories[order.category][order.product]) {
                        const product = storeData.categories[order.category][order.product];
                        if (product.stock > 0) product.stock -= 1;
                    }
                } else {
                    showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 'error');
                    return;
                }
            }
            
            await save_data(storeData);
            loadAllOrders();
            showNotification('–°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ –æ–±–Ω–æ–≤–ª–µ–Ω', 'success');
        }

        function loadAdminCategories() {
            const select = document.getElementById('productCategorySelect');
            select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>';
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            for (const category of Object.keys(storeData.categories)) {
                const option = document.createElement('option');
                option.value = category;
                option.textContent = category;
                select.appendChild(option);
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–ø—Ü–∏—é –¥–ª—è –Ω–æ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            const newOption = document.createElement('option');
            newOption.value = "__new__";
            newOption.textContent = "+ –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é";
            select.appendChild(newOption);
        }

        async function saveProduct() {
            const category = document.getElementById('productCategorySelect').value;
            const name = document.getElementById('productName').value.trim();
            const price = parseFloat(document.getElementById('productPrice').value);
            const stock = parseInt(document.getElementById('productStock').value);
            const description = document.getElementById('productDescription').value.trim();
            
            if (!name || isNaN(price) || isNaN(stock)) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'warning');
                return;
            }
            
            let actualCategory = category;
            
            // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
            if (category === "__new__") {
                actualCategory = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:');
                if (!actualCategory) return;
                if (!storeData.categories[actualCategory]) {
                    storeData.categories[actualCategory] = {};
                }
            } else if (!storeData.categories[category]) {
                storeData.categories[category] = {};
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º/–æ–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–≤–∞—Ä
            storeData.categories[actualCategory][name] = {
                price: price,
                stock: stock,
                description: description,
                updatedAt: new Date().toISOString()
            };
            
            await save_data(storeData);
            loadAdminCategories();
            loadProducts();
            
            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('productName').value = '';
            document.getElementById('productPrice').value = '';
            document.getElementById('productStock').value = '';
            document.getElementById('productDescription').value = '';
            
            showNotification('–¢–æ–≤–∞—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω', 'success');
        }

        async function deleteProduct() {
            const category = document.getElementById('productCategorySelect').value;
            const name = document.getElementById('productName').value.trim();
            
            if (!category || !name) {
                showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ —Ç–æ–≤–∞—Ä', 'warning');
                return;
            }
            
            if (!storeData.categories[category] || !storeData.categories[category][name]) {
                showNotification('–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                return;
            }
            
            if (!confirm(`–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä "${name}" –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "${category}"?`)) return;
            
            delete storeData.categories[category][name];
            
            // –ï—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ø—É—Å—Ç–∞—è - —É–¥–∞–ª—è–µ–º –µ—ë
            if (Object.keys(storeData.categories[category]).length === 0) {
                delete storeData.categories[category];
            }
            
            await save_data(storeData);
            loadAdminCategories();
            loadProducts();
            
            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('productName').value = '';
            document.getElementById('productPrice').value = '';
            document.getElementById('productStock').value = '';
            document.getElementById('productDescription').value = '';
            
            showNotification('–¢–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω', 'success');
        }

        function loadUsersList() {
            const container = document.getElementById('usersList');
            const users = storeData.users;
            
            if (Object.keys(users).length === 0) {
                container.innerHTML = '<p class="text-center">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ—Ç</p>';
                return;
            }
            
            let html = '';
            for (const [username, user] of Object.entries(users)) {
                html += `
                    <div class="order-card">
                        <div class="order-header">
                            <div>
                                <h4>${username}</h4>
                                <small>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: ${new Date(user.createdAt).toLocaleDateString()}</small>
                            </div>
                        </div>
                        <p>–ë–∞–ª–∞–Ω—Å: ${user.balance} ‚Ç¥</p>
                        <p>–ê–¥—Ä–µ—Å: ${user.address || '–ù–µ —É–∫–∞–∑–∞–Ω'}</p>
                        <div class="mt-20">
                            <input type="number" id="balance_${username}" placeholder="–°—É–º–º–∞" style="width: 150px; padding: 8px; margin-right: 10px;">
                            <button class="btn btn-primary btn-sm" onclick="updateUserBalance('${username}')">
                                üí∞ –ò–∑–º–µ–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å
                            </button>
                        </div>
                    </div>
                `;
            }
            
            container.innerHTML = html;
        }

        function searchUsers() {
            const searchTerm = document.getElementById('userSearch').value.toLowerCase();
            const userCards = document.querySelectorAll('#usersList .order-card');
            
            userCards.forEach(card => {
                const username = card.querySelector('h4').textContent.toLowerCase();
                card.style.display = username.includes(searchTerm) ? '' : 'none';
            });
        }

        async function updateUserBalance(username) {
            const input = document.getElementById(`balance_${username}`);
            const amount = parseFloat(input.value);
            
            if (isNaN(amount) || amount === 0) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—É–º–º—É', 'warning');
                return;
            }
            
            storeData.users[username].balance += amount;
            await save_data(storeData);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å–ª–∏ —ç—Ç–æ –æ–Ω
            if (currentUser === username) {
                updateUI();
            }
            
            loadUsersList();
            input.value = '';
            showNotification(`–ë–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${username} –æ–±–Ω–æ–≤–ª–µ–Ω`, 'success');
        }

        async function changeAdminPassword() {
            const newPass = document.getElementById('newAdminPassword').value;
            const confirmPass = document.getElementById('confirmAdminPassword').value;
            
            if (!newPass || !confirmPass) {
                showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'warning');
                return;
            }
            
            if (newPass !== confirmPass) {
                showNotification('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç', 'error');
                return;
            }
            
            if (newPass.length < 4) {
                showNotification('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 4 —Å–∏–º–≤–æ–ª–æ–≤', 'warning');
                return;
            }
            
            storeData.adminPassword = newPass;
            await save_data(storeData);
            
            document.getElementById('newAdminPassword').value = '';
            document.getElementById('confirmAdminPassword').value = '';
            
            showNotification('–ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∏–∑–º–µ–Ω–µ–Ω', 'success');
        }

        // ===================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò =====================
        function updateUI() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å
            if (currentUser && storeData.users[currentUser]) {
                document.getElementById('balanceAmount').textContent = storeData.users[currentUser].balance + ' ‚Ç¥';
                document.getElementById('authBtnText').textContent = currentUser;
                document.getElementById('authBtn').classList.add('hidden');
                document.getElementById('logoutBtn').classList.remove('hidden');
            } else {
                document.getElementById('balanceAmount').textContent = '0 ‚Ç¥';
                document.getElementById('authBtnText').textContent = '–í–æ–π—Ç–∏';
                document.getElementById('authBtn').classList.remove('hidden');
                document.getElementById('logoutBtn').classList.add('hidden');
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –∞–¥–º–∏–Ω–∞
            document.getElementById('adminBtn').classList.toggle('hidden', currentUser === 'admin');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–≤–∞—Ä—ã –µ—Å–ª–∏ –Ω–∞ –≤–∫–ª–∞–¥–∫–µ —Ç–æ–≤–∞—Ä–æ–≤
            if (document.getElementById('productsTab').classList.contains('active')) {
                loadProducts();
            }
        }

        function showNotification(message, type = 'info') {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            let icon = '‚ÑπÔ∏è';
            if (type === 'success') icon = '‚úÖ';
            if (type === 'error') icon = '‚ùå';
            if (type === 'warning') icon = '‚ö†Ô∏è';
            
            notification.innerHTML = `
                <span>${icon}</span>
                <span>${message}</span>
            `;
            
            container.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // ===================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====================
        async function init() {
            console.log('üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–∞–≥–∞–∑–∏–Ω–∞...');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–∞
            storeData = await get_data();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                try {
                    const userData = JSON.parse(savedUser);
                    currentUser = userData.username;
                    isAdmin = userData.isAdmin || false;
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', e);
                }
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateUI();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–≤–∞—Ä—ã
            loadProducts();
            
            console.log('‚úÖ –ú–∞–≥–∞–∑–∏–Ω –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!');
            showNotification('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ SuperShop!', 'success');
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
